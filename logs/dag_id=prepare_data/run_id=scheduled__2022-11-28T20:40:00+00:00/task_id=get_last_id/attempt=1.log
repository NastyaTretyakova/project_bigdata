[2022-12-12 18:44:02,178] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: prepare_data.get_last_id scheduled__2022-11-28T20:40:00+00:00 [queued]>
[2022-12-12 18:44:02,337] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: prepare_data.get_last_id scheduled__2022-11-28T20:40:00+00:00 [queued]>
[2022-12-12 18:44:02,339] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-12-12 18:44:02,342] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2022-12-12 18:44:02,343] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-12-12 18:44:02,527] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): get_last_id> on 2022-11-28 20:40:00+00:00
[2022-12-12 18:44:02,541] {standard_task_runner.py:52} INFO - Started process 1703 to run task
[2022-12-12 18:44:02,588] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'prepare_data', 'get_last_id', 'scheduled__2022-11-28T20:40:00+00:00', '--job-id', '727', '--raw', '--subdir', 'DAGS_FOLDER/prepare_data.py', '--cfg-path', '/tmp/tmpitpp_038', '--error-file', '/tmp/tmpjt7x_zir']
[2022-12-12 18:44:02,625] {standard_task_runner.py:80} INFO - Job 727: Subtask get_last_id
[2022-12-12 18:44:03,575] {task_command.py:369} INFO - Running <TaskInstance: prepare_data.get_last_id scheduled__2022-11-28T20:40:00+00:00 [running]> on host cfea470654c7
[2022-12-12 18:44:04,226] {local_task_job.py:84} ERROR - Received SIGTERM. Terminating subprocesses
[2022-12-12 18:44:04,394] {process_utils.py:129} INFO - Sending Signals.SIGTERM to group 1703. PIDs of all processes in the group: [1703]
[2022-12-12 18:44:04,404] {process_utils.py:80} INFO - Sending the signal Signals.SIGTERM to group 1703
[2022-12-12 18:44:04,441] {taskinstance.py:1541} ERROR - Received SIGTERM. Terminating subprocesses.
[2022-12-12 18:44:04,453] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 32, in create_session
    yield session
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 71, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 941, in clear_xcom_data
    session=session,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 68, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 566, in clear
    query.delete()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 3111, in delete
    execution_options={"synchronize_session": synchronize_session},
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1670, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1520, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 314, in _execute_on_connection
    self, multiparams, params, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1387, in _execute_clauseelement
    linting=self.dialect.compiler_linting | compiler.WARN_LINTING,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 518, in _compile_w_cache
    elem_cache_key = self._generate_cache_key()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 1169, in oneshot
    result = fn(self, *args, **kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/traversals.py", line 266, in _generate_cache_key
    return HasCacheKey._generate_cache_key(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/traversals.py", line 245, in _generate_cache_key
    key = self._gen_cache_key(_anon_map, bindparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/traversals.py", line 199, in _gen_cache_key
    for elem in obj
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/traversals.py", line 199, in <listcomp>
    for elem in obj
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/traversals.py", line 164, in _gen_cache_key
    obj._gen_cache_key(anon_map, bindparams),
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/traversals.py", line 189, in _gen_cache_key
    result += self._annotations_cache_key
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 1090, in __get__
    def __get__(self, obj, cls):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1543, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 896, in _rollback_impl
    self.engine.dialect.do_rollback(self.connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 666, in do_rollback
    dbapi_connection.rollback()
psycopg2.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1451, in _run_raw_task
    self._execute_task_with_callbacks(context, test_mode)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1549, in _execute_task_with_callbacks
    self.clear_xcom_data()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 71, in wrapper
    return func(*args, session=session, **kwargs)
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 35, in create_session
    session.rollback()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1387, in rollback
    self._transaction.rollback(_to_root=self.future)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 900, in rollback
    util.raise_(rollback_err[1], with_traceback=rollback_err[2])
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 865, in rollback
    t[1].rollback()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2243, in rollback
    self._do_rollback()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2433, in _do_rollback
    self._close_impl(try_deactivate=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2416, in _close_impl
    self._connection_rollback_impl()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2408, in _connection_rollback_impl
    self.connection._rollback_impl()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 898, in _rollback_impl
    self._handle_dbapi_exception(e, None, None, None, None)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1930, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 896, in _rollback_impl
    self.engine.dialect.do_rollback(self.connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 666, in do_rollback
    dbapi_connection.rollback()
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: http://sqlalche.me/e/14/e3q8)
[2022-12-12 18:44:04,628] {standard_task_runner.py:97} ERROR - Failed to execute job 727 for task get_last_id ((psycopg2.OperationalError) connection to server at "db" (172.18.0.3), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: http://sqlalche.me/e/14/e3q8); 1703)
[2022-12-12 18:44:04,759] {process_utils.py:75} INFO - Process psutil.Process(pid=1703, status='terminated', exitcode=1, started='18:44:02') (1703) terminated with exit code 1
[2022-12-12 18:44:04,767] {local_task_job.py:156} INFO - Task exited with return code 143
